<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SCL-90症状自评量表</title>
    <!-- Tailwind CSS v3 -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script>
    <!-- 统一的 Tailwind 配置 -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3b82f6',
                        secondary: '#10b981',
                        accent: '#06b6d4',
                        light: '#e0f2fe',
                        dark: '#0f172a'
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-in-out',
                        'slide-in': 'slideIn 0.5s ease-in-out',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        },
                        slideIn: {
                            '0%': { transform: 'translateY(20px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' },
                        },
                    },
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .text-shadow {
                text-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }
            .bg-gradient {
                background: linear-gradient(135deg, #3b82f6 0%, #10b981 100%);
            }
            .transition-all-300 {
                transition: all 300ms ease-in-out;
            }
        }
        
        /* 自定义样式 */
        body {
            font-family: 'Inter', system-ui, sans-serif;
            background-color: #f8fafc;
        }
        
        .question-card {
            transition: all 0.3s ease;
        }
        
        .question-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px -5px rgba(59, 130, 246, 0.1), 0 10px 10px -5px rgba(59, 130, 246, 0.04);
        }
        
        .option-btn {
            transition: all 0.2s ease;
        }
        
        .option-btn:hover {
            transform: translateY(-1px);
        }
        
        .option-btn.active {
            border-color: #3b82f6;
            background-color: rgba(59, 130, 246, 0.1);
        }
        
        .progress-bar {
            transition: width 0.5s ease;
        }
        
        .result-card {
            animation: fadeIn 0.5s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }
        
        /* 响应式调整 */
        @media (max-width: 768px) {
            .chart-container {
                height: 250px;
            }
        }
    </style>
</head>
<body class="min-h-screen">
    <!-- 背景图 -->
    <div class="fixed inset-0 z-0 opacity-10">
        <img src="https://p9-flow-imagex-sign.byteimg.com/tos-cn-i-a9rns2rl98/rc/pc/super_tool/18bd30ffdc734cc29a1d0f6922c1b92e~tplv-a9rns2rl98-image.image?rcl=20251113221420BD608D4DE73AA49CE83F&rk3s=8e244e95&rrcfp=f06b921b&x-expires=1765635284&x-signature=npXH768qxbMfW08wc7J%2F%2FHwdGEA%3D" 
             alt="背景" class="w-full h-full object-cover">
    </div>

    <!-- 主容器 -->
    <div class="relative z-10 min-h-screen flex flex-col">
        <!-- 顶部导航 -->
        <header class="bg-white bg-opacity-90 backdrop-blur-sm shadow-sm">
            <div class="container mx-auto px-4 py-4 flex justify-between items-center">
                <div class="flex items-center">
                    <i class="fa fa-heart-o text-primary text-2xl mr-2"></i>
                    <h1 class="text-xl font-bold text-gray-800">SCL-90症状自评量表</h1>
                </div>
                <nav>
                    <ul class="flex space-x-6">
                        <li><a href="#" class="text-gray-600 hover:text-primary transition-all-300 font-medium" id="nav-home">首页</a></li>
                        <li><a href="#" class="text-gray-600 hover:text-primary transition-all-300 font-medium" id="nav-test">开始测试</a></li>
                        <li><a href="#" class="text-gray-600 hover:text-primary transition-all-300 font-medium" id="nav-history">历史记录</a></li>
                        <li><a href="#" class="text-gray-600 hover:text-primary transition-all-300 font-medium" id="nav-about">关于量表</a></li>
                    </ul>
                </nav>
            </div>
        </header>

        <!-- 主内容区 -->
        <main class="flex-grow container mx-auto px-4 py-8">
            <!-- 首页 -->
            <section id="section-home" class="animate-fade-in">
                <div class="max-w-3xl mx-auto text-center">
                    <h2 class="text-4xl font-bold text-gray-800 mb-6 text-shadow">心理健康自我评估</h2>
                    <p class="text-lg text-gray-600 mb-8">SCL-90症状自评量表是世界上最著名的心理健康测试量表之一，用于评估您最近一周的心理健康状况。</p>
                    
                    <div class="bg-white rounded-xl shadow-lg p-8 mb-8">
                        <h3 class="text-2xl font-semibold text-gray-800 mb-4">量表介绍</h3>
                        <p class="text-gray-600 mb-4">SCL-90（Symptom Checklist 90）是由德若伽提斯（L.R.Derogatis）于1975年编制的一种精神症状自评量表。它包含90个项目，涵盖了广泛的精神病症状学内容，从感觉、情感、思维、意识、行为直至生活习惯、人际关系、饮食睡眠等方面。</p>
                        <p class="text-gray-600">该量表通过10个因子分别反映10个方面的心理症状情况，是目前心理健康评估中应用最广泛的量表之一。</p>
                    </div>
                    
                    <div class="grid md:grid-cols-3 gap-6 mb-8">
                        <div class="bg-white rounded-xl shadow-lg p-6 hover:shadow-xl transition-all-300">
                            <div class="text-primary text-3xl mb-4">
                                <i class="fa fa-check-circle"></i>
                            </div>
                            <h3 class="text-xl font-semibold text-gray-800 mb-2">科学可靠</h3>
                            <p class="text-gray-600">经过多年临床验证，具有良好的信度和效度</p>
                        </div>
                        
                        <div class="bg-white rounded-xl shadow-lg p-6 hover:shadow-xl transition-all-300">
                            <div class="text-primary text-3xl mb-4">
                                <i class="fa fa-clock-o"></i>
                            </div>
                            <h3 class="text-xl font-semibold text-gray-800 mb-2">快速便捷</h3>
                            <p class="text-gray-600">仅需10-15分钟即可完成全部90道题目</p>
                        </div>
                        
                        <div class="bg-white rounded-xl shadow-lg p-6 hover:shadow-xl transition-all-300">
                            <div class="text-primary text-3xl mb-4">
                                <i class="fa fa-bar-chart"></i>
                            </div>
                            <h3 class="text-xl font-semibold text-gray-800 mb-2">专业分析</h3>
                            <p class="text-gray-600">自动生成详细评估报告，提供专业建议</p>
                        </div>
                    </div>
                    
                    <button id="start-test-btn" class="bg-gradient text-white text-lg font-medium py-3 px-8 rounded-full shadow-lg hover:shadow-xl transition-all-300 transform hover:-translate-y-1">
                        开始测试
                    </button>
                </div>
            </section>

            <!-- 测试说明 -->
            <section id="section-instructions" class="hidden animate-fade-in">
                <div class="max-w-3xl mx-auto">
                    <div class="bg-white rounded-xl shadow-lg p-8">
                        <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center">测试说明</h2>
                        
                        <div class="mb-6">
                            <h3 class="text-xl font-semibold text-gray-800 mb-2">测试目的</h3>
                            <p class="text-gray-600">本测试旨在评估您最近一周（包括今天）的心理健康状况，帮助您了解自己的心理状态。</p>
                        </div>
                        
                        <div class="mb-6">
                            <h3 class="text-xl font-semibold text-gray-800 mb-2">测试方法</h3>
                            <p class="text-gray-600">本测试包含90个问题，请仔细阅读每一条，然后根据最近一周内下述情况影响您的实际感觉，选择适合您的选项：</p>
                            <ul class="list-disc list-inside mt-2 text-gray-600">
                                <li><strong>A. 没有</strong> - 表示您在这方面没有任何困扰</li>
                                <li><strong>B. 很轻</strong> - 表示您在这方面有轻微的困扰</li>
                                <li><strong>C. 中等</strong> - 表示您在这方面有中等程度的困扰</li>
                                <li><strong>D. 偏重</strong> - 表示您在这方面有较严重的困扰</li>
                                <li><strong>E. 严重</strong> - 表示您在这方面有非常严重的困扰</li>
                            </ul>
                        </div>
                        
                        <div class="mb-6">
                            <h3 class="text-xl font-semibold text-gray-800 mb-2">注意事项</h3>
                            <ul class="list-disc list-inside text-gray-600">
                                <li>请根据您的真实感受回答，不要考虑"应该"怎样</li>
                                <li>每个问题只能选择一个答案</li>
                                <li>测试过程中可以随时暂停，系统会自动保存您的进度</li>
                                <li>测试结果仅供参考，不能替代专业医疗诊断</li>
                                <li>如您有严重的心理困扰，请及时寻求专业心理咨询或治疗</li>
                            </ul>
                        </div>
                        
                        <div class="flex justify-center mt-8">
                            <button id="back-to-home-btn" class="bg-gray-200 text-gray-700 font-medium py-2 px-6 rounded-lg mr-4 hover:bg-gray-300 transition-all-300">
                                返回首页
                            </button>
                            <button id="continue-test-btn" class="bg-primary text-white font-medium py-2 px-6 rounded-lg hover:bg-blue-600 transition-all-300">
                                继续测试
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 测试页面 -->
            <section id="section-test" class="hidden animate-fade-in">
                <div class="max-w-3xl mx-auto">
                    <!-- 进度条 -->
                    <div class="bg-white rounded-xl shadow-sm p-4 mb-6">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm font-medium text-gray-600">进度</span>
                            <span class="text-sm font-medium text-primary" id="progress-text">1/90</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2.5">
                            <div class="bg-primary h-2.5 rounded-full progress-bar" style="width: 1%"></div>
                        </div>
                    </div>
                    
                    <!-- 题目卡片 -->
                    <div class="bg-white rounded-xl shadow-lg p-6 mb-6 question-card">
                        <div class="flex items-start mb-4">
                            <span class="bg-primary text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mr-2 mt-0.5" id="question-number">1</span>
                            <h3 class="text-lg font-medium text-gray-800" id="question-text">头痛</h3>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-5 gap-3 mt-6" id="options-container">
                            <button class="option-btn border border-gray-300 rounded-lg py-2 px-3 text-center hover:border-primary focus:outline-none focus:ring-2 focus:ring-primary focus:ring-opacity-50" data-score="1">
                                <div class="font-medium text-gray-800">A</div>
                                <div class="text-sm text-gray-600">没有</div>
                            </button>
                            <button class="option-btn border border-gray-300 rounded-lg py-2 px-3 text-center hover:border-primary focus:outline-none focus:ring-2 focus:ring-primary focus:ring-opacity-50" data-score="2">
                                <div class="font-medium text-gray-800">B</div>
                                <div class="text-sm text-gray-600">很轻</div>
                            </button>
                            <button class="option-btn border border-gray-300 rounded-lg py-2 px-3 text-center hover:border-primary focus:outline-none focus:ring-2 focus:ring-primary focus:ring-opacity-50" data-score="3">
                                <div class="font-medium text-gray-800">C</div>
                                <div class="text-sm text-gray-600">中等</div>
                            </button>
                            <button class="option-btn border border-gray-300 rounded-lg py-2 px-3 text-center hover:border-primary focus:outline-none focus:ring-2 focus:ring-primary focus:ring-opacity-50" data-score="4">
                                <div class="font-medium text-gray-800">D</div>
                                <div class="text-sm text-gray-600">偏重</div>
                            </button>
                            <button class="option-btn border border-gray-300 rounded-lg py-2 px-3 text-center hover:border-primary focus:outline-none focus:ring-2 focus:ring-primary focus:ring-opacity-50" data-score="5">
                                <div class="font-medium text-gray-800">E</div>
                                <div class="text-sm text-gray-600">严重</div>
                            </button>
                        </div>
                    </div>
                    
                    <!-- 导航按钮 -->
                    <div class="flex justify-between">
                        <button id="prev-btn" class="bg-gray-200 text-gray-700 font-medium py-2 px-6 rounded-lg hover:bg-gray-300 transition-all-300 disabled:opacity-50 disabled:cursor-not-allowed">
                            <i class="fa fa-arrow-left mr-2"></i>上一题
                        </button>
                        <button id="next-btn" class="bg-primary text-white font-medium py-2 px-6 rounded-lg hover:bg-blue-600 transition-all-300 disabled:opacity-50 disabled:cursor-not-allowed">
                            下一题<i class="fa fa-arrow-right ml-2"></i>
                        </button>
                    </div>
                </div>
            </section>

            <!-- 结果页面 -->
            <section id="section-result" class="hidden animate-fade-in">
                <div class="max-w-4xl mx-auto">
                    <div class="bg-white rounded-xl shadow-lg p-8 mb-6">
                        <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center">评估结果</h2>
                        
                        <!-- 总体评估 -->
                        <div class="mb-8">
                            <h3 class="text-xl font-semibold text-gray-800 mb-4">总体评估</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="bg-gray-50 rounded-lg p-4">
                                    <div class="flex justify-between items-center mb-2">
                                        <span class="text-gray-600">总分</span>
                                        <span class="text-lg font-semibold text-primary" id="total-score">0</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2.5">
                                        <div class="bg-primary h-2.5 rounded-full" id="total-score-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                                
                                <div class="bg-gray-50 rounded-lg p-4">
                                    <div class="flex justify-between items-center mb-2">
                                        <span class="text-gray-600">总均分</span>
                                        <span class="text-lg font-semibold text-primary" id="average-score">0</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2.5">
                                        <div class="bg-primary h-2.5 rounded-full" id="average-score-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                                
                                <div class="bg-gray-50 rounded-lg p-4">
                                    <div class="flex justify-between items-center mb-2">
                                        <span class="text-gray-600">阳性项目数</span>
                                        <span class="text-lg font-semibold text-primary" id="positive-count">0</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2.5">
                                        <div class="bg-primary h-2.5 rounded-full" id="positive-count-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                                
                                <div class="bg-gray-50 rounded-lg p-4">
                                    <div class="flex justify-between items-center mb-2">
                                        <span class="text-gray-600">阳性症状均分</span>
                                        <span class="text-lg font-semibold text-primary" id="positive-average">0</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2.5">
                                        <div class="bg-primary h-2.5 rounded-full" id="positive-average-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 因子分图表 -->
                        <div class="mb-8">
                            <h3 class="text-xl font-semibold text-gray-800 mb-4">因子分分析</h3>
                            <div class="chart-container">
                                <canvas id="factor-chart"></canvas>
                            </div>
                        </div>
                        
                        <!-- 因子分详情 -->
                        <div class="mb-8">
                            <h3 class="text-xl font-semibold text-gray-800 mb-4">因子分详情</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="factor-details">
                                <!-- 因子分详情将通过JavaScript动态生成 -->
                            </div>
                        </div>
                        
                        <!-- 结果解释 -->
                        <div class="mb-8">
                            <h3 class="text-xl font-semibold text-gray-800 mb-4">结果解释</h3>
                            <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded-r-lg">
                                <p class="text-gray-700" id="result-interpretation">
                                    <!-- 结果解释将通过JavaScript动态生成 -->
                                </p>
                            </div>
                        </div>
                        
                        <!-- 建议 -->
                        <div class="mb-8">
                            <h3 class="text-xl font-semibold text-gray-800 mb-4">建议</h3>
                            <div class="bg-green-50 border-l-4 border-green-500 p-4 rounded-r-lg">
                                <ul class="list-disc list-inside text-gray-700" id="suggestions">
                                    <!-- 建议将通过JavaScript动态生成 -->
                                </ul>
                            </div>
                        </div>
                        
                        <!-- 操作按钮 -->
                        <div class="flex justify-center space-x-4">
                            <button id="save-result-btn" class="bg-secondary text-white font-medium py-2 px-6 rounded-lg hover:bg-green-600 transition-all-300">
                                <i class="fa fa-save mr-2"></i>保存结果
                            </button>
                            <button id="print-result-btn" class="bg-gray-200 text-gray-700 font-medium py-2 px-6 rounded-lg hover:bg-gray-300 transition-all-300">
                                <i class="fa fa-print mr-2"></i>打印报告
                            </button>
                            <button id="restart-test-btn" class="bg-primary text-white font-medium py-2 px-6 rounded-lg hover:bg-blue-600 transition-all-300">
                                <i class="fa fa-refresh mr-2"></i>重新测试
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 历史记录 -->
            <section id="section-history" class="hidden animate-fade-in">
                <div class="max-w-3xl mx-auto">
                    <div class="bg-white rounded-xl shadow-lg p-8">
                        <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center">历史测试记录</h2>
                        
                        <div id="history-empty" class="text-center py-8">
                            <div class="text-gray-400 text-5xl mb-4">
                                <i class="fa fa-history"></i>
                            </div>
                            <p class="text-gray-600 mb-4">您还没有任何测试记录</p>
                            <button id="start-first-test-btn" class="bg-primary text-white font-medium py-2 px-6 rounded-lg hover:bg-blue-600 transition-all-300">
                                开始第一次测试
                            </button>
                        </div>
                        
                        <div id="history-list" class="hidden">
                            <!-- 历史记录将通过JavaScript动态生成 -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- 关于量表 -->
            <section id="section-about" class="hidden animate-fade-in">
                <div class="max-w-3xl mx-auto">
                    <div class="bg-white rounded-xl shadow-lg p-8">
                        <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center">关于SCL-90量表</h2>
                        
                        <div class="mb-6">
                            <h3 class="text-xl font-semibold text-gray-800 mb-2">量表简介</h3>
                            <p class="text-gray-600 mb-4">SCL-90（Symptom Checklist 90）症状自评量表，又名90项症状清单，是由德若伽提斯（L.R.Derogatis）于1975年编制的一种精神症状自评量表。它是在SCL-58的基础上扩展而成的，包含90个项目，涵盖了广泛的精神病症状学内容。</p>
                            <p class="text-gray-600">SCL-90在国内外精神科和心理咨询门诊中广泛应用，用于评估个体的心理健康状况，也可用于流行病学调查。</p>
                        </div>
                        
                        <div class="mb-6">
                            <h3 class="text-xl font-semibold text-gray-800 mb-2">量表结构</h3>
                            <p class="text-gray-600 mb-4">SCL-90包含9个因子，分别从不同维度反映心理状态：</p>
                            <ul class="list-disc list-inside text-gray-600 space-y-2">
                                <li><strong>躯体化</strong>：主要反映主观的身体不适感，包括心血管、胃肠道、呼吸等系统的不适以及头痛、背痛等躯体疼痛症状。</li>
                                <li><strong>强迫症状</strong>：体现那种明知没有必要，但又无法摆脱的无意义的思想、冲动和行为。</li>
                                <li><strong>人际关系敏感</strong>：评估个体在人际交往中的不自在与自卑感，如对别人的批评或轻视过分敏感等。</li>
                                <li><strong>抑郁</strong>：测量抑郁苦闷的感情和心境，包含对生活的兴趣减退、缺乏活动愿望、丧失活动能力等症状。</li>
                                <li><strong>焦虑</strong>：反映紧张、不安、焦虑情绪及自主神经系统功能失调的症状。</li>
                                <li><strong>敌对</strong>：涵盖厌烦、争论、摔物、争斗和不可抑制的冲动爆发等方面。</li>
                                <li><strong>恐怖</strong>：主要针对广场恐怖、社交恐怖及特定的恐怖症状。</li>
                                <li><strong>偏执</strong>：主要涉及猜疑、关系妄想、被动体验和夸大等偏执性思维特征。</li>
                                <li><strong>精神病性</strong>：用于检测幻听、思维播散、被控制感、思维被插入等精神分裂样症状。</li>
                            </ul>
                        </div>
                        
                        <div class="mb-6">
                            <h3 class="text-xl font-semibold text-gray-800 mb-2">评分标准</h3>
                            <p class="text-gray-600 mb-4">SCL-90采用五级评分制，从"没有"到"严重"分别记为1至5分。得分越高，表明个体在相应维度上的症状越明显，心理问题可能越严重。</p>
                            <p class="text-gray-600 mb-4">量表的统计指标主要为两项，即总分和因子分：</p>
                            <ul class="list-disc list-inside text-gray-600 space-y-2">
                                <li><strong>总分</strong>：90个项目单项分相加之和，能反映其病情严重程度。</li>
                                <li><strong>总均分</strong>：总分/90，表示从总体情况看，该受检者的自我感觉位于1-5级间的哪一个分值程度上。</li>
                                <li><strong>阳性项目数</strong>：单项分≥2的项目数，表示受检者在多少项目上呈有"病状"。</li>
                                <li><strong>阴性项目数</strong>：单项分=1的项目数，表示受检者"无症状"的项目有多少。</li>
                                <li><strong>阳性症状均分</strong>：(总分-阴性项目数)/阳性项目数，表示受检者在"有症状"项目中的平均得分。</li>
                                <li><strong>因子分</strong>：组成某一因子的各项总分与组成某一因子的项目数之比。</li>
                            </ul>
                        </div>
                        
                        <div class="mb-6">
                            <h3 class="text-xl font-semibold text-gray-800 mb-2">适用人群</h3>
                            <p class="text-gray-600">SCL-90适用于16岁以上的成人，能较好地反映个体近期的心理健康状况。该量表不适用于躁狂症和精神分裂症患者。</p>
                        </div>
                        
                        <div class="mb-6">
                            <h3 class="text-xl font-semibold text-gray-800 mb-2">注意事项</h3>
                            <p class="text-gray-600 mb-4">本测试结果仅供参考，不能替代专业医疗诊断。如果您的测试结果显示存在较严重的心理问题，建议您及时寻求专业心理咨询或治疗。</p>
                            <p class="text-gray-600">心理健康是一个动态的过程，一次测试结果不能代表您的长期心理状态。建议定期进行自我评估，关注自己的心理健康变化。</p>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- 页脚 -->
        <footer class="bg-gray-800 text-white py-8">
            <div class="container mx-auto px-4">
                <div class="flex flex-col md:flex-row justify-between items-center">
                    <div class="mb-4 md:mb-0">
                        <div class="flex items-center">
                            <i class="fa fa-heart-o text-primary text-2xl mr-2"></i>
                            <h2 class="text-xl font-bold">SCL-90症状自评量表</h2>
                        </div>
                        <p class="text-gray-400 mt-2">专业心理健康自我评估工具</p>
                    </div>
                    
                    <div class="flex flex-col md:flex-row md:space-x-8">
                        <div class="mb-4 md:mb-0">
                            <h3 class="text-lg font-semibold mb-2">快速链接</h3>
                            <ul class="space-y-1">
                                <li><a href="#" class="text-gray-400 hover:text-primary transition-all-300" id="footer-home">首页</a></li>
                                <li><a href="#" class="text-gray-400 hover:text-primary transition-all-300" id="footer-test">开始测试</a></li>
                                <li><a href="#" class="text-gray-400 hover:text-primary transition-all-300" id="footer-history">历史记录</a></li>
                                <li><a href="#" class="text-gray-400 hover:text-primary transition-all-300" id="footer-about">关于量表</a></li>
                            </ul>
                        </div>
                        
                        <div>
                            <h3 class="text-lg font-semibold mb-2">重要提示</h3>
                            <p class="text-gray-400">本测试结果仅供参考，不能替代专业医疗诊断。如有严重心理困扰，请及时寻求专业帮助。</p>
                        </div>
                    </div>
                </div>
                
                <div class="border-t border-gray-700 mt-8 pt-6 text-center text-gray-400">
                    <p>&copy; 2025 SCL-90症状自评量表. 保留所有权利.</p>
                </div>
            </div>
        </footer>
    </div>

    <!-- JavaScript -->
    <script>
        // SCL-90题目数据
        const scl90Questions = [
            { id: 1, text: "头痛", factor: "躯体化" },
            { id: 2, text: "神经过敏，心中不踏实", factor: "焦虑" },
            { id: 3, text: "头脑中有不必要的想法或字句盘旋", factor: "强迫症状" },
            { id: 4, text: "头昏或昏倒", factor: "躯体化" },
            { id: 5, text: "对异性的兴趣减退", factor: "抑郁" },
            { id: 6, text: "对旁人责备求全", factor: "人际关系敏感" },
            { id: 7, text: "感到别人能控制您的思想", factor: "精神病性" },
            { id: 8, text: "责怪别人制造麻烦", factor: "偏执" },
            { id: 9, text: "忘性大", factor: "强迫症状" },
            { id: 10, text: "担心自己的衣饰整齐及仪态的端正", factor: "强迫症状" },
            { id: 11, text: "容易烦恼和激动", factor: "敌对" },
            { id: 12, text: "胸痛", factor: "躯体化" },
            { id: 13, text: "害怕空旷的场所或街道", factor: "恐怖" },
            { id: 14, text: "感到自己的精力下降，活动减慢", factor: "抑郁" },
            { id: 15, text: "想结束自己的生命", factor: "抑郁" },
            { id: 16, text: "听到旁人听不到的声音", factor: "精神病性" },
            { id: 17, text: "发抖", factor: "焦虑" },
            { id: 18, text: "感到大多数人都不可信任", factor: "偏执" },
            { id: 19, text: "胃口不好", factor: "其他" },
            { id: 20, text: "容易哭泣", factor: "抑郁" },
            { id: 21, text: "同异性相处时感到害羞不自在", factor: "人际关系敏感" },
            { id: 22, text: "感到受骗，中了圈套或有人想抓住您", factor: "偏执" },
            { id: 23, text: "无缘无故地突然感到害怕", factor: "焦虑" },
            { id: 24, text: "自己不能控制地大发脾气", factor: "敌对" },
            { id: 25, text: "怕单独出门", factor: "恐怖" },
            { id: 26, text: "经常责怪自己", factor: "抑郁" },
            { id: 27, text: "腰痛", factor: "躯体化" },
            { id: 28, text: "感到难以完成任务", factor: "强迫症状" },
            { id: 29, text: "感到孤独", factor: "抑郁" },
            { id: 30, text: "感到苦闷", factor: "抑郁" },
            { id: 31, text: "过分担忧", factor: "焦虑" },
            { id: 32, text: "对事物不感兴趣", factor: "抑郁" },
            { id: 33, text: "感到害怕", factor: "焦虑" },
            { id: 34, text: "感情容易受到伤害", factor: "人际关系敏感" },
            { id: 35, text: "旁人能知道您的私下想法", factor: "精神病性" },
            { id: 36, text: "感到别人不理解您不同情您", factor: "人际关系敏感" },
            { id: 37, text: "感到人们对您不友好，不喜欢您", factor: "人际关系敏感" },
            { id: 38, text: "做事必须做得很慢以保证做得正确", factor: "强迫症状" },
            { id: 39, text: "心跳得很厉害", factor: "焦虑" },
            { id: 40, text: "恶心或胃部不舒服", factor: "躯体化" },
            { id: 41, text: "感到比不上他人", factor: "人际关系敏感" },
            { id: 42, text: "肌肉酸痛", factor: "躯体化" },
            { id: 43, text: "感到有人在监视您谈论您", factor: "偏执" },
            { id: 44, text: "难以入睡", factor: "其他" },
            { id: 45, text: "做事必须反复检查", factor: "强迫症状" },
            { id: 46, text: "难以作出决定", factor: "强迫症状" },
            { id: 47, text: "怕乘电车、公共汽车、地铁或火车", factor: "恐怖" },
            { id: 48, text: "呼吸有困难", factor: "躯体化" },
            { id: 49, text: "一阵阵发冷或发热", factor: "躯体化" },
            { id: 50, text: "因为感到害怕而避开某些东西、场合或活动", factor: "恐怖" },
            { id: 51, text: "脑子变空了", factor: "强迫症状" },
            { id: 52, text: "身体发麻或刺痛", factor: "躯体化" },
            { id: 53, text: "喉咙有梗塞感", factor: "躯体化" },
            { id: 54, text: "感到对前途没有希望", factor: "抑郁" },
            { id: 55, text: "不能集中注意力", factor: "强迫症状" },
            { id: 56, text: "感到身体的某一部分软弱无力", factor: "躯体化" },
            { id: 57, text: "感到紧张或容易紧张", factor: "焦虑" },
            { id: 58, text: "感到手或脚发重", factor: "躯体化" },
            { id: 59, text: "想到有关死亡的事", factor: "其他" },
            { id: 60, text: "吃得太多", factor: "其他" },
            { id: 61, text: "当别人看着您或谈论您时感到不自在", factor: "人际关系敏感" },
            { id: 62, text: "有一些不属于您自己的想法", factor: "精神病性" },
            { id: 63, text: "有想打人或伤害他人的冲动", factor: "敌对" },
            { id: 64, text: "醒得太早", factor: "其他" },
            { id: 65, text: "必须反复洗手、点数目或触摸某些东西", factor: "强迫症状" },
            { id: 66, text: "睡得不稳不深", factor: "其他" },
            { id: 67, text: "有想摔坏或破坏东西的冲动", factor: "敌对" },
            { id: 68, text: "有一些别人没有的想法或念头", factor: "偏执" },
            { id: 69, text: "感到对别人神经过敏", factor: "人际关系敏感" },
            { id: 70, text: "在商店或电影院等人多的地方感到不自在", factor: "恐怖" },
            { id: 71, text: "感到任何事情都很困难", factor: "抑郁" },
            { id: 72, text: "一阵阵恐惧或惊恐", factor: "焦虑" },
            { id: 73, text: "感到在公共场合吃东西很不舒服", factor: "人际关系敏感" },
            { id: 74, text: "经常与人争论", factor: "敌对" },
            { id: 75, text: "单独一人时神经很紧张", factor: "恐怖" },
            { id: 76, text: "别人对您的成绩没有作出恰当的评价", factor: "偏执" },
            { id: 77, text: "即使和别人在一起也感到孤单", factor: "抑郁" },
            { id: 78, text: "感到坐立不安心神不宁", factor: "焦虑" },
            { id: 79, text: "感到自己没有什么价值", factor: "抑郁" },
            { id: 80, text: "感到熟悉的东西变成陌生或不像是真的", factor: "精神病性" },
            { id: 81, text: "大叫或摔东西", factor: "敌对" },
            { id: 82, text: "害怕会在公共场合昏倒", factor: "恐怖" },
            { id: 83, text: "感到别人想占您的便宜", factor: "偏执" },
            { id: 84, text: "为一些有关性的想法而很苦恼", factor: "精神病性" },
            { id: 85, text: "您认为应该因为自己的过错而受到惩罚", factor: "抑郁" },
            { id: 86, text: "感到要很快把事情做完", factor: "焦虑" },
            { id: 87, text: "感到自己的身体有严重问题", factor: "精神病性" },
            { id: 88, text: "从未感到和其他人很亲近", factor: "人际关系敏感" },
            { id: 89, text: "感到自己有罪", factor: "其他" },
            { id: 90, text: "感到自己的脑子有毛病", factor: "精神病性" }
        ];

        // 因子分类
        const factorCategories = {
            "躯体化": [1, 4, 12, 27, 40, 42, 48, 49, 52, 53, 56, 58],
            "强迫症状": [3, 9, 10, 28, 38, 45, 46, 51, 55, 65],
            "人际关系敏感": [6, 21, 34, 36, 37, 41, 61, 69, 73, 88],
            "抑郁": [5, 14, 15, 20, 22, 26, 29, 30, 31, 32, 54, 71, 77, 79, 85],
            "焦虑": [2, 17, 23, 33, 39, 57, 72, 78, 86],
            "敌对": [11, 24, 63, 67, 74, 81],
            "恐怖": [13, 25, 47, 50, 70, 75, 82],
            "偏执": [8, 18, 22, 43, 68, 76, 83],
            "精神病性": [7, 16, 35, 62, 77, 80, 84, 87, 90],
            "其他": [19, 44, 59, 60, 64, 66, 89]
        };

        // 因子正常范围
        const factorNormalRanges = {
            "躯体化": { min: 0, max: 24, cutoff: 24 },
            "强迫症状": { min: 0, max: 20, cutoff: 20 },
            "人际关系敏感": { min: 0, max: 18, cutoff: 18 },
            "抑郁": { min: 0, max: 26, cutoff: 26 },
            "焦虑": { min: 0, max: 20, cutoff: 20 },
            "敌对": { min: 0, max: 12, cutoff: 12 },
            "恐怖": { min: 0, max: 14, cutoff: 14 },
            "偏执": { min: 0, max: 12, cutoff: 12 },
            "精神病性": { min: 0, max: 20, cutoff: 20 },
            "其他": { min: 0, max: 14, cutoff: 14 }
        };

        // 全局变量
        let currentQuestionIndex = 0;
        const userAnswers = new Array(90).fill(0);
        let factorChart = null;

        // DOM元素
        const sections = {
            home: document.getElementById('section-home'),
            instructions: document.getElementById('section-instructions'),
            test: document.getElementById('section-test'),
            result: document.getElementById('section-result'),
            history: document.getElementById('section-history'),
            about: document.getElementById('section-about')
        };

        const navLinks = {
            home: document.getElementById('nav-home'),
            test: document.getElementById('nav-test'),
            history: document.getElementById('nav-history'),
            about: document.getElementById('nav-about')
        };

        const footerLinks = {
            home: document.getElementById('footer-home'),
            test: document.getElementById('footer-test'),
            history: document.getElementById('footer-history'),
            about: document.getElementById('footer-about')
        };

        // 导航函数
        function showSection(sectionId) {
            // 隐藏所有部分
            Object.values(sections).forEach(section => {
                section.classList.add('hidden');
            });
            
            // 显示选定部分
            sections[sectionId].classList.remove('hidden');
            
            // 更新导航链接状态
            Object.values(navLinks).forEach(link => {
                link.classList.remove('text-primary');
                link.classList.add('text-gray-600');
            });
            
            if (navLinks[sectionId]) {
                navLinks[sectionId].classList.remove('text-gray-600');
                navLinks[sectionId].classList.add('text-primary');
            }
        }

        // 初始化测试
        function initTest() {
            currentQuestionIndex = 0;
            updateQuestion();
            updateProgress();
            
            // 禁用上一题按钮
            document.getElementById('prev-btn').disabled = true;
            
            // 禁用下一题按钮（直到选择答案）
            document.getElementById('next-btn').disabled = true;
        }

        // 更新问题
        function updateQuestion() {
            const question = scl90Questions[currentQuestionIndex];
            document.getElementById('question-number').textContent = question.id;
            document.getElementById('question-text').textContent = question.text;
            
            // 重置选项按钮
            const optionButtons = document.querySelectorAll('.option-btn');
            optionButtons.forEach(btn => {
                btn.classList.remove('active');
                if (userAnswers[currentQuestionIndex] > 0) {
                    if (parseInt(btn.dataset.score) === userAnswers[currentQuestionIndex]) {
                        btn.classList.add('active');
                    }
                }
            });
            
            // 更新导航按钮状态
            document.getElementById('prev-btn').disabled = currentQuestionIndex === 0;
            document.getElementById('next-btn').disabled = userAnswers[currentQuestionIndex] === 0;
        }

        // 更新进度
        function updateProgress() {
            const progress = ((currentQuestionIndex + 1) / 90) * 100;
            document.querySelector('.progress-bar').style.width = `${progress}%`;
            document.getElementById('progress-text').textContent = `${currentQuestionIndex + 1}/90`;
        }

        // 计算测试结果
        function calculateResults() {
            // 计算总分
            const totalScore = userAnswers.reduce((sum, score) => sum + score, 0);
            
            // 计算总均分
            const averageScore = totalScore / 90;
            
            // 计算阳性项目数
            const positiveCount = userAnswers.filter(score => score >= 2).length;
            
            // 计算阴性项目数
            const negativeCount = userAnswers.filter(score => score === 1).length;
            
            // 计算阳性症状均分
            const positiveAverage = positiveCount > 0 ? (totalScore - negativeCount) / positiveCount : 0;
            
            // 计算各因子分
            const factorScores = {};
            Object.keys(factorCategories).forEach(factor => {
                const questions = factorCategories[factor];
                const score = questions.reduce((sum, qId) => sum + userAnswers[qId - 1], 0);
                factorScores[factor] = {
                    score: score,
                    average: score / questions.length,
                    count: questions.length
                };
            });
            
            return {
                totalScore,
                averageScore,
                positiveCount,
                negativeCount,
                positiveAverage,
                factorScores
            };
        }

        // 显示测试结果
        function showResults() {
            const results = calculateResults();
            
            // 更新总体评估
            document.getElementById('total-score').textContent = results.totalScore;
            document.getElementById('total-score-bar').style.width = `${(results.totalScore / 450) * 100}%`;
            
            document.getElementById('average-score').textContent = results.averageScore.toFixed(2);
            document.getElementById('average-score-bar').style.width = `${(results.averageScore / 5) * 100}%`;
            
            document.getElementById('positive-count').textContent = results.positiveCount;
            document.getElementById('positive-count-bar').style.width = `${(results.positiveCount / 90) * 100}%`;
            
            document.getElementById('positive-average').textContent = results.positiveAverage.toFixed(2);
            document.getElementById('positive-average-bar').style.width = `${(results.positiveAverage / 5) * 100}%`;
            
            // 更新因子分图表
            updateFactorChart(results.factorScores);
            
            // 更新因子分详情
            updateFactorDetails(results.factorScores);
            
            // 更新结果解释
            updateResultInterpretation(results);
            
            // 更新建议
            updateSuggestions(results);
            
            // 保存结果到本地存储
            saveResultToHistory(results);
            
            // 显示结果页面
            showSection('result');
        }

        // 更新因子分图表
        function updateFactorChart(factorScores) {
            const ctx = document.getElementById('factor-chart').getContext('2d');
            
            // 销毁旧图表
            if (factorChart) {
                factorChart.destroy();
            }
            
            // 准备数据
            const factors = Object.keys(factorScores).filter(factor => factor !== '其他');
            const scores = factors.map(factor => factorScores[factor].score);
            const cutoffs = factors.map(factor => factorNormalRanges[factor].cutoff);
            
            // 创建新图表
            factorChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: factors,
                    datasets: [
                        {
                            label: '您的得分',
                            data: scores,
                            backgroundColor: 'rgba(59, 130, 246, 0.7)',
                            borderColor: 'rgba(59, 130, 246, 1)',
                            borderWidth: 1
                        },
                        {
                            label: '临界值',
                            data: cutoffs,
                            type: 'line',
                            borderColor: 'rgba(239, 68, 68, 1)',
                            borderWidth: 2,
                            pointBackgroundColor: 'rgba(239, 68, 68, 1)',
                            fill: false
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: '得分'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: '因子'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        tooltip: {
                            callbacks: {
                                afterLabel: function(context) {
                                    const factor = factors[context.dataIndex];
                                    const avg = factorScores[factor].average.toFixed(2);
                                    return `平均分: ${avg}`;
                                }
                            }
                        }
                    }
                }
            });
        }

        // 更新因子分详情
        function updateFactorDetails(factorScores) {
            const container = document.getElementById('factor-details');
            container.innerHTML = '';
            
            Object.keys(factorScores).forEach(factor => {
                if (factor === '其他') return;
                
                const score = factorScores[factor].score;
                const average = factorScores[factor].average.toFixed(2);
                const cutoff = factorNormalRanges[factor].cutoff;
                const isAbnormal = score > cutoff;
                
                const factorElement = document.createElement('div');
                factorElement.className = `bg-gray-50 rounded-lg p-4 ${isAbnormal ? 'border-l-4 border-red-500' : ''}`;
                
                factorElement.innerHTML = `
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-gray-600">${factor}</span>
                        <span class="text-lg font-semibold ${isAbnormal ? 'text-red-500' : 'text-primary'}">${score}/${factorNormalRanges[factor].max}</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2.5 mb-2">
                        <div class="${isAbnormal ? 'bg-red-500' : 'bg-primary'} h-2.5 rounded-full" style="width: ${(score / factorNormalRanges[factor].max) * 100}%"></div>
                    </div>
                    <div class="text-sm text-gray-500">平均分: ${average} ${isAbnormal ? '<span class="text-red-500">(超出正常范围)</span>' : '<span class="text-green-500">(正常范围)</span>'}</div>
                `;
                
                container.appendChild(factorElement);
            });
        }

        // 更新结果解释
        function updateResultInterpretation(results) {
            const interpretationElement = document.getElementById('result-interpretation');
            let interpretation = '';
            
            // 根据总均分判断总体情况
            if (results.averageScore < 1.5) {
                interpretation += '您的心理健康状况良好，没有明显的心理症状。';
            } else if (results.averageScore < 2.5) {
                interpretation += '您有轻度的心理症状，但发生得并不频繁，对日常生活影响较小。';
            } else if (results.averageScore < 3.5) {
                interpretation += '您有中度的心理症状，这些症状可能会对您的日常生活产生一定影响。';
            } else if (results.averageScore < 4.5) {
                interpretation += '您有较严重的心理症状，这些症状已经对您的日常生活产生了明显影响。';
            } else {
                interpretation += '您有非常严重的心理症状，这些症状已经严重影响了您的日常生活。';
            }
            
            // 分析异常因子
            const abnormalFactors = [];
            Object.keys(results.factorScores).forEach(factor => {
                if (factor !== '其他' && results.factorScores[factor].score > factorNormalRanges[factor].cutoff) {
                    abnormalFactors.push(factor);
                }
            });
            
            if (abnormalFactors.length > 0) {
                interpretation += ` 您在以下方面可能存在心理健康问题：${abnormalFactors.join('、')}。`;
                
                // 根据异常因子提供更具体的解释
                if (abnormalFactors.includes('躯体化')) {
                    interpretation += ' 您可能经常感到身体不适，如头痛、背痛、肌肉酸痛等，但这些症状可能与心理因素有关。';
                }
                if (abnormalFactors.includes('强迫症状')) {
                    interpretation += ' 您可能存在一些不必要的想法或行为，明知没有必要但无法摆脱。';
                }
                if (abnormalFactors.includes('人际关系敏感')) {
                    interpretation += ' 您在人际交往中可能感到不自在或自卑，对他人的评价过于敏感。';
                }
                if (abnormalFactors.includes('抑郁')) {
                    interpretation += ' 您可能经常感到情绪低落、兴趣减退、精力不足等。';
                }
                if (abnormalFactors.includes('焦虑')) {
                    interpretation += ' 您可能经常感到紧张、不安、担心等焦虑情绪。';
                }
                if (abnormalFactors.includes('敌对')) {
                    interpretation += ' 您可能容易产生敌对情绪，如厌烦、争论、脾气暴发等。';
                }
                if (abnormalFactors.includes('恐怖')) {
                    interpretation += ' 您可能对某些场所或情境存在恐惧，如空旷场所、社交场合等。';
                }
                if (abnormalFactors.includes('偏执')) {
                    interpretation += ' 您可能存在猜疑、敌对、妄想等偏执性思维。';
                }
                if (abnormalFactors.includes('精神病性')) {
                    interpretation += ' 您可能出现一些精神病性症状，如幻觉、思维紊乱等。';
                }
            }
            
            interpretation += ' 请注意，本测试结果仅供参考，不能替代专业医疗诊断。如果您对测试结果有疑问，建议咨询专业心理医生或心理咨询师。';
            
            interpretationElement.textContent = interpretation;
        }

        // 更新建议
        function updateSuggestions(results) {
            const suggestionsElement = document.getElementById('suggestions');
            suggestionsElement.innerHTML = '';
            
            // 基础建议
            const baseSuggestions = [
                '保持良好的生活习惯，包括规律作息、健康饮食和适当运动。',
                '学习并实践压力管理技巧，如深呼吸、冥想、渐进性肌肉放松等。',
                '保持社交活动，与亲友保持联系，分享情绪和经历。',
                '培养兴趣爱好，丰富生活内容，增加积极情绪体验。',
                '定期进行自我评估，关注自己的心理健康变化。'
            ];
            
            baseSuggestions.forEach(suggestion => {
                const li = document.createElement('li');
                li.textContent = suggestion;
                suggestionsElement.appendChild(li);
            });
            
            // 根据异常因子提供更具体的建议
            const abnormalFactors = [];
            Object.keys(results.factorScores).forEach(factor => {
                if (factor !== '其他' && results.factorScores[factor].score > factorNormalRanges[factor].cutoff) {
                    abnormalFactors.push(factor);
                }
            });
            
            if (abnormalFactors.length > 0) {
                const li = document.createElement('li');
                li.textContent = '根据您的测试结果，建议您：';
                suggestionsElement.appendChild(li);
                
                if (abnormalFactors.includes('躯体化')) {
                    const li = document.createElement('li');
                    li.textContent = '- 关注身体症状，但不要过度担忧，这些症状可能与心理压力有关。';
                    suggestionsElement.appendChild(li);
                }
                if (abnormalFactors.includes('强迫症状')) {
                    const li = document.createElement('li');
                    li.textContent = '- 学习接纳不完美，减少对细节的过度关注，必要时可尝试认知行为疗法。';
                    suggestionsElement.appendChild(li);
                }
                if (abnormalFactors.includes('人际关系敏感')) {
                    const li = document.createElement('li');
                    li.textContent = '- 参加社交技能培训，增强自信心，学习更有效的沟通方式。';
                    suggestionsElement.appendChild(li);
                }
                if (abnormalFactors.includes('抑郁')) {
                    const li = document.createElement('li');
                    li.textContent = '- 保持规律的日常活动，增加愉快体验，必要时寻求专业帮助。';
                    suggestionsElement.appendChild(li);
                }
                if (abnormalFactors.includes('焦虑')) {
                    const li = document.createElement('li');
                    li.textContent = '- 学习放松技巧，如深呼吸、渐进性肌肉放松等，减少焦虑情绪。';
                    suggestionsElement.appendChild(li);
                }
                if (abnormalFactors.includes('敌对')) {
                    const li = document.createElement('li');
                    li.textContent = '- 学习情绪管理技巧，如情绪识别、情绪表达和情绪调节等。';
                    suggestionsElement.appendChild(li);
                }
                if (abnormalFactors.includes('恐怖')) {
                    const li = document.createElement('li');
                    li.textContent = '- 尝试系统脱敏法，逐步面对恐惧对象，必要时寻求专业帮助。';
                    suggestionsElement.appendChild(li);
                }
                if (abnormalFactors.includes('偏执')) {
                    const li = document.createElement('li');
                    li.textContent = '- 尝试从不同角度看待问题，增加对他人的信任，必要时寻求专业帮助。';
                    suggestionsElement.appendChild(li);
                }
                if (abnormalFactors.includes('精神病性')) {
                    const li = document.createElement('li');
                    li.textContent = '- 建议尽快寻求专业心理医生或精神科医生的帮助。';
                    suggestionsElement.appendChild(li);
                }
            }
            
            // 如果症状严重，建议寻求专业帮助
            if (results.averageScore >= 3.5) {
                const li = document.createElement('li');
                li.className = 'font-semibold text-red-600';
                li.textContent = '您的症状较为严重，强烈建议您尽快寻求专业心理咨询或治疗。';
                suggestionsElement.appendChild(li);
            }
        }

        // 保存结果到历史记录
        function saveResultToHistory(results) {
            const history = JSON.parse(localStorage.getItem('scl90History') || '[]');
            
            const newRecord = {
                id: Date.now(),
                date: new Date().toLocaleString(),
                results: results
            };
            
            history.push(newRecord);
            localStorage.setItem('scl90History', JSON.stringify(history));
        }

        // 加载历史记录
        function loadHistory() {
            const history = JSON.parse(localStorage.getItem('scl90History') || '[]');
            const historyEmpty = document.getElementById('history-empty');
            const historyList = document.getElementById('history-list');
            
            if (history.length === 0) {
                historyEmpty.classList.remove('hidden');
                historyList.classList.add('hidden');
                return;
            }
            
            historyEmpty.classList.add('hidden');
            historyList.classList.remove('hidden');
            
            // 清空历史记录列表
            historyList.innerHTML = '';
            
            // 添加历史记录
            history.forEach(record => {
                const recordElement = document.createElement('div');
                recordElement.className = 'bg-gray-50 rounded-lg p-4 mb-4';
                
                // 计算异常因子
                const abnormalFactors = [];
                Object.keys(record.results.factorScores).forEach(factor => {
                    if (factor !== '其他' && record.results.factorScores[factor].score > factorNormalRanges[factor].cutoff) {
                        abnormalFactors.push(factor);
                    }
                });
                
                recordElement.innerHTML = `
                    <div class="flex justify-between items-center mb-2">
                        <h4 class="text-lg font-semibold text-gray-800">测试日期: ${record.date}</h4>
                        <div class="flex space-x-2">
                            <button class="view-result-btn bg-primary text-white text-sm py-1 px-3 rounded hover:bg-blue-600 transition-all-300" data-id="${record.id}">
                                查看详情
                            </button>
                            <button class="delete-result-btn bg-red-500 text-white text-sm py-1 px-3 rounded hover:bg-red-600 transition-all-300" data-id="${record.id}">
                                删除
                            </button>
                        </div>
                    </div>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-2 mb-2">
                        <div class="bg-white rounded p-2 text-center">
                            <div class="text-sm text-gray-600">总分</div>
                            <div class="font-semibold text-primary">${record.results.totalScore}</div>
                        </div>
                        <div class="bg-white rounded p-2 text-center">
                            <div class="text-sm text-gray-600">总均分</div>
                            <div class="font-semibold text-primary">${record.results.averageScore.toFixed(2)}</div>
                        </div>
                        <div class="bg-white rounded p-2 text-center">
                            <div class="text-sm text-gray-600">阳性项目数</div>
                            <div class="font-semibold text-primary">${record.results.positiveCount}</div>
                        </div>
                        <div class="bg-white rounded p-2 text-center">
                            <div class="text-sm text-gray-600">异常因子数</div>
                            <div class="font-semibold ${abnormalFactors.length > 0 ? 'text-red-500' : 'text-green-500'}">${abnormalFactors.length}</div>
                        </div>
                    </div>
                    ${abnormalFactors.length > 0 ? `
                        <div class="bg-red-50 border-l-4 border-red-500 p-3 rounded-r-lg">
                            <div class="text-sm font-medium text-red-700">异常因子: ${abnormalFactors.join('、')}</div>
                        </div>
                    ` : `
                        <div class="bg-green-50 border-l-4 border-green-500 p-3 rounded-r-lg">
                            <div class="text-sm font-medium text-green-700">所有因子均在正常范围内</div>
                        </div>
                    `}
                `;
                
                historyList.appendChild(recordElement);
            });
            
            // 添加查看详情按钮事件
            document.querySelectorAll('.view-result-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const recordId = parseInt(this.dataset.id);
                    const record = history.find(r => r.id === recordId);
                    
                    if (record) {
                        // 使用历史记录结果更新结果页面
                        document.getElementById('total-score').textContent = record.results.totalScore;
                        document.getElementById('total-score-bar').style.width = `${(record.results.totalScore / 450) * 100}%`;
                        
                        document.getElementById('average-score').textContent = record.results.averageScore.toFixed(2);
                        document.getElementById('average-score-bar').style.width = `${(record.results.averageScore / 5) * 100}%`;
                        
                        document.getElementById('positive-count').textContent = record.results.positiveCount;
                        document.getElementById('positive-count-bar').style.width = `${(record.results.positiveCount / 90) * 100}%`;
                        
                        document.getElementById('positive-average').textContent = record.results.positiveAverage.toFixed(2);
                        document.getElementById('positive-average-bar').style.width = `${(record.results.positiveAverage / 5) * 100}%`;
                        
                        // 更新因子分图表
                        updateFactorChart(record.results.factorScores);
                        
                        // 更新因子分详情
                        updateFactorDetails(record.results.factorScores);
                        
                        // 更新结果解释
                        updateResultInterpretation(record.results);
                        
                        // 更新建议
                        updateSuggestions(record.results);
                        
                        // 显示结果页面
                        showSection('result');
                    }
                });
            });
            
            // 添加删除按钮事件
            document.querySelectorAll('.delete-result-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    if (confirm('确定要删除这条记录吗？')) {
                        const recordId = parseInt(this.dataset.id);
                        const updatedHistory = history.filter(r => r.id !== recordId);
                        localStorage.setItem('scl90History', JSON.stringify(updatedHistory));
                        loadHistory(); // 重新加载历史记录
                    }
                });
            });
        }

        // 事件监听器
        document.addEventListener('DOMContentLoaded', function() {
            // 导航链接事件
            navLinks.home.addEventListener('click', function(e) {
                e.preventDefault();
                showSection('home');
            });
            
            navLinks.test.addEventListener('click', function(e) {
                e.preventDefault();
                showSection('instructions');
            });
            
            navLinks.history.addEventListener('click', function(e) {
                e.preventDefault();
                loadHistory();
                showSection('history');
            });
            
            navLinks.about.addEventListener('click', function(e) {
                e.preventDefault();
                showSection('about');
            });
            
            // 页脚链接事件
            footerLinks.home.addEventListener('click', function(e) {
                e.preventDefault();
                showSection('home');
            });
            
            footerLinks.test.addEventListener('click', function(e) {
                e.preventDefault();
                showSection('instructions');
            });
            
            footerLinks.history.addEventListener('click', function(e) {
                e.preventDefault();
                loadHistory();
                showSection('history');
            });
            
            footerLinks.about.addEventListener('click', function(e) {
                e.preventDefault();
                showSection('about');
            });
            
            // 开始测试按钮
            document.getElementById('start-test-btn').addEventListener('click', function() {
                showSection('instructions');
            });
            
            // 返回首页按钮
            document.getElementById('back-to-home-btn').addEventListener('click', function() {
                showSection('home');
            });
            
            // 继续测试按钮
            document.getElementById('continue-test-btn').addEventListener('click', function() {
                initTest();
                showSection('test');
            });
            
            // 开始第一次测试按钮
            document.getElementById('start-first-test-btn').addEventListener('click', function() {
                showSection('instructions');
            });
            
            // 选项按钮事件
            document.querySelectorAll('.option-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    // 移除其他选项的active类
                    document.querySelectorAll('.option-btn').forEach(b => {
                        b.classList.remove('active');
                    });
                    
                    // 添加当前选项的active类
                    this.classList.add('active');
                    
                    // 保存答案
                    userAnswers[currentQuestionIndex] = parseInt(this.dataset.score);
                    
                    // 启用下一题按钮
                    document.getElementById('next-btn').disabled = false;
                });
            });
            
            // 上一题按钮
            document.getElementById('prev-btn').addEventListener('click', function() {
                if (currentQuestionIndex > 0) {
                    currentQuestionIndex--;
                    updateQuestion();
                    updateProgress();
                }
            });
            
            // 下一题按钮
            document.getElementById('next-btn').addEventListener('click', function() {
                if (currentQuestionIndex < 89) {
                    currentQuestionIndex++;
                    updateQuestion();
                    updateProgress();
                } else {
                    // 完成测试，显示结果
                    showResults();
                }
            });
            
            // 保存结果按钮
            document.getElementById('save-result-btn').addEventListener('click', function() {
                alert('结果已自动保存到历史记录中。');
            });
            
            // 打印报告按钮
            document.getElementById('print-result-btn').addEventListener('click', function() {
                window.print();
            });
            
            // 重新测试按钮
            document.getElementById('restart-test-btn').addEventListener('click', function() {
                // 重置答案
                userAnswers.fill(0);
                
                // 初始化测试
                initTest();
                
                // 显示测试页面
                showSection('test');
            });
            
            // 显示首页
            showSection('home');
        });
    </script>
</body>
</html>